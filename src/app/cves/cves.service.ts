import { Injectable } from '@angular/core';
import { Cve } from './cve.model';

@Injectable({
  providedIn: 'root'
})
export class CvesService {
  private cves: Cve[] = [
    {
      id: 'c1',
      title: 'CVE-2021-34527',
      imageUrl: 'https://socprime.com/wp-content/uploads/PrintNightmare-CVE-2021-1675.jpg',
      severity: ['high', 'critical'],
      description: 'An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.'
    },
    {
      id: 'c2',
      title: 'CVE-2019-10768',
      imageUrl: 'https://socprime.com/wp-content/uploads/PrintNightmare-CVE-2021-1675.jpg',
      severity: ['medium', 'low'],
      description: 'the function `merge()` could be tricked into adding or modifying properties of `Object.prototype` using a `__proto__`'
    }

  ];
  constructor() { }

  getAllCves() {
    return [...this.cves];
  }

  getCve(cveId: string) {
    return {
      // eslint-disable-next-line arrow-body-style
      ...this.cves.find(cve => {
          return cve.id === cveId;
      })
    };
  }

  // getCve(cveId: string) {
  //   return {
  //     ...this.cves.find(cve => {
  //       return cve.id === cveId;
  //     })
  //   };
  // }
}
